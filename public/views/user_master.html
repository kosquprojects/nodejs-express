
<link href="../assets/css/jqry.min.css" rel="stylesheet" />
<link href="https://cdn.datatables.net/buttons/2.2.2/css/buttons.dataTables.min.css" rel="stylesheet" />
<style>
	.glyphicon {  margin-bottom: 10px;margin-right: 10px;}

small {
display: block;
line-height: 1.428571429;
color: #999;
}
</style>
<div class="col-md-12" id="userlisttbl">
	<div class="panel">

		<div class="panel-heading">
			<span class="panel-icon"></span>
			<span class="panel-title sizeTitle"><i class="fa fa-user"></i> Visitor List</span>

			<button  type="button" style="color: black;font-weight: bold;margin-top: 3px;" class="btn btn-sm pull-right" onclick="ExportToExcel('xlsx')" style="margin-top: 5px;"><img src="../assets/img/xls.png" style="width: 20px;height: 20px;"/>Export Excel</button>

		</div>
		<div class="panel-body">

			<table class="table table-striped table-bordered datatab display nowrap" id="makerTable12">
				<thead class="thead-light">
					<tr>

						<th>Visitor Name</th>
						<th>Visitor Email ID</th>
						<th>Contact Person Name</th>
						<th>Reason To Meet</th>
						<th>Date</th>
						<th>In Time</th>
						<th>Out Time</th>
					</tr>
				</thead>
			</table>
		</div>
	</div>
</div>


<section id="content_form" class="table-layout">

	<div class="tray tray-center" style="height: 610px;">

		<!-- <div class="content-header">
  <h2> AdminForms makes <b class="text-primary">Validation</b> is easier than ever</h2>
  <p class="lead">Use the Admin Forms you know and love to help build the perfect form.</p>
  </div> -->

		<div class="admin-form theme-primary mw1000 center-block" style="padding-bottom: 175px;">
			<div class="panel heading-border panel-primary">
				<form id="form-user" method="post" onsubmit="return false;">
					<div class="panel-body bg-light">
						<div class="section-divider mt20 mb40">
							<span> Visitor Form </span>
						</div>

						<div class="section row" id="spy1">
							<div class="col-md-6">
								<input type="hidden" id="n_emp_auto_id" class="form-control">
								
								<label>Employee Name</label>
								
								<input type="text" class="form-control input-sm" id="s_emp_name" placeholder="Employee Name" name="s_emp_name"
									data-validation="required">
								
								</div>

							<div class="col-md-6">
								<label>Employee Id</label>
									<input type="text" name="s_emp_id" id="s_emp_id" class="form-control input-sm"
										placeholder="Employee id" data-validation="required">


							</div>
						</div>
						<div class="section row" id="spy1">
							<div class="col-md-6">
								<label>Designation</label>

									<input type="text" name="s_designation" id="s_designation" class="form-control input-sm"
										placeholder="Designation" data-validation="required" >
							</div>

							<div class="col-md-6">
								<label>Email Id</label>
									<input type="email" class="form-control input-sm" id="s_email_id" name="s_email_id"
										placeholder="Email Id" data-validation="required,email">


							</div>

						</div>
						<div class="section row" id="spy1">
							<div class="col-md-6">
								<label>Mobile Number</label>
									<input type="text" class="form-control input-sm" id="n_mobile_no" placeholder="Mobile Number"
										name="n_mobile_no" data-validation="required">

									<!-- <input type="url" name="website" id="website" class="gui-input" placeholder="Current website url"> -->

							</div>
							<div class="col-md-6">
								<label>Office</label>
									<input type="text" name="s_office" id="s_office" class="form-control input-sm"
										placeholder="Office" data-validation="required">
							</div>

						</div>

						<div class="section row" id="spy1">
							<div class="col-md-6">
								<label>Department</label>
									<input type="text" name="s_dept_name" id="s_dept_name" class="form-control input-sm"
										placeholder="Office" data-validation="required">

							</div>
							<div class="col-md-6">
								<label>Company Name</label>


									<input type="text" class="form-control input-sm" id="s_company" placeholder="Company Name"
										name="s_company" data-validation="required">

									<!-- <input type="url" name="website" id="website" class="gui-input" placeholder="Current website url"> -->
							</div>

						</div>
						<div class="section row" id="spy1">
							<div class="col-md-6">
								<label>Location</label>
								<!-- <label for="rolename"> </label> -->
									<input type="text" class="form-control input-sm" id="s_location" placeholder="Location"
										name="s_location" data-validation="required">

									<!-- <input type="url" name="website" id="website" class="gui-input" placeholder="Current website url"> -->

							</div>
							<div class="col-md-6">
								<label>Password</label>
									<input type="password" name="s_pass" id="s_pass" class="form-control input-sm"
										placeholder="Create a password" data-validation="required">
							</div>
						</div>
						<div class="section row" id="spy1">
							<div class="col-md-6">
								<label>Upload Images</label>
								<input type="file" accept="image/*" capture="camera">

							</div>

						</div>
						<div class="section row" id="spy1">
								<div class="col-md-6">
										<label>Status</label>
												<select name="n_status" id="n_status" class="form-control input-sm" data-validation="required">
														<option value="">----Select Option----</option>
														<option value="1">Activate</option>
														<option value="0">Deactivate</option>
												</select>
									</div>

					</div>
					<div class="row">
							<div class="col-md-6 col-sm-6 ">
								<button type="button" class="btn active btn-info btn-sm" id="saveuser">Save</button>
								<button type="button" class="btn active btn-info btn-sm" id="updateuser" >Update</button>
								<button type="reset" id="resetuser" class="btn active btn-warning btn-sm"
									onclick="back()">Back</button>
						<!--<a class="btn btn-outline-secondary  btn-sm" onclick="back()"><b>Back</b></a>-->

							</div>
							
						</div>
					</div>
				</form>
			</div>
		</div>

	</div>

</section>

<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered" role="document">
	  <div class="modal-content">
		<div class="modal-header">
		  <h5 class="modal-title" id="exampleModalLongTitle">User Details</h5>
		</div>
		<div class="modal-body">
		  <div id="userdatamodal"></div>
		</div>
		<div class="modal-footer">
		  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
		</div>
	  </div>
	</div>
  </div>


<script>
	$.validate({
		modules: 'html5,file'
	});
		$('#content_form').hide();


	$('#s_about_me').restrictLength($('#max-length-element'));
	$('#s_address').restrictLength($('#max-length-element'));
	// $("#content_form").hide();
	// function divopennclose(){
	// 	$("#content_form").show();
	// 	$("#userlisttbl").hide();
	// }
	// function divopennclose_(){
	// 	$("#content_form").hide();
	// 	$("#userlisttbl").show();
	// }
</script>

<script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>

<script src="../assets/transaction/user_master.js"></script>

<script>
	function ExportToExcel(type, fn, dl) {
		debugger
       var elt = document.getElementById('makerTable12');
       var wb = XLSX.utils.table_to_book(elt, { sheet: "sheet1" });
       return dl ?
         XLSX.write(wb, { bookType: type, bookSST: true, type: 'base64' }):
         XLSX.writeFile(wb, fn || ('Visitor_Data.' + (type || 'xlsx')));
    }
</script>
